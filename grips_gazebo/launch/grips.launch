<launch>
	<!-- roslaunch arguments -->
	<arg name="world_name" default="$(find grips_gazebo)/worlds/grips.world"/>
	<arg name="robot_name" default="grips_simple_gripper"/>
	<arg name="spawn_args" default=""/>
	<arg name="show_rviz" default="true"/>
	<arg name="debug" default="false"/>
	<arg name="paused" default="true"/>
	<arg name="gui" default="true"/>

	<!-- We resume the logic in empty_world.launch, changing only the name of 
		the world to be launched -->
	<include file="$(find gazebo_ros)/launch/empty_world.launch">
		<arg name="world_name" value="$(arg world_name)" />
		<arg name="debug" value="$(arg debug)" />
		<arg name="gui" value="$(arg gui)" />
		<arg name="paused" value="$(arg paused)" />
		<arg name="use_sim_time" value="true" />
		<arg name="headless" value="false" />
	</include>
	
	<!-- load joint controller configurations from YAML file to parameter server -->
	<rosparam file="$(find grips_control)/config/joint_position_control.yaml" command="load" />
	
	<!-- send robots urdfs to param server -->
	<param name="robot_description" command="$(find xacro)/xacro.py '$(find grips_description)/robots/$(arg robot_name).xacro'" />

	<!-- push robot_description to factory and spawn robot in gazebo -->
	<node name="$(arg robot_name)_spawn" pkg="gazebo_ros" type="spawn_model" output="screen" 
				args="-urdf -param robot_description -model $(arg robot_name)
							$(arg spawn_args)" />

	<!-- load the controllers -->
	<node name="$(arg robot_name)_controller" pkg="controller_manager" type="spawner" output="screen" 
			args="--namespace=/$(arg robot_name) SA SE WP WY WR linkage_tr linkage_tl linkage_bl
			r_outer l_outer r_inner l_inner r_finger l_finger joint_state_controller" />

	<!-- start a node to control the four bar linkage -->
	<node name="$(arg robot_name)_four_bar" pkg="grips_control" type="four_bar_linkage.py" output="log" ns="$(arg robot_name)"/>
	
	<!-- start a node to control the simple_gripper -->
	<node name="$(arg robot_name)_gripper" pkg="grips_control" type="simple_gripper_control.py" output="log" ns="$(arg robot_name)"/>
	
	<!-- start robot state publisher -->
	<node name="$(arg robot_name)_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" output="screen">
		<param name="publish_frequency" type="double" value="50.0" />
		<remap from="joint_states" to="$(arg robot_name)/joint_states"/>
	</node>
	
	<!-- Show in Rviz -->
	<group if="$(arg show_rviz)">
		<node name="rviz" pkg="rviz" type="rviz" output="screen" args="-d $(find grips_gazebo)/launch/grips.rviz"/> 
	</group>
	
</launch>
